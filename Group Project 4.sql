-- Drop the tables if they exist
DROP TABLE SALES_HISTORY;
DROP TABLE SALES_CUSTOMER; 
DROP TABLE SALES_SALESPERSON;
DROP TABLE SALES_PRODUCT;

CREATE TABLE SALES_Customer(
CUSTOMER_ID NUMERIC CONSTRAINT CUSTOMER_ID PRIMARY KEY,
FIRST_NAME VARCHAR2(50),
LAST_NAME VARCHAR2(50),
MIDDLE_NAME VARCHAR2(50),
ADDRESS_LINE1 VARCHAR2(80),
ADDRESS_LINE2 VARCHAR2(80),
CITY VARCHAR2(40),
COUNTRY VARCHAR2(50),
DATE_ADDED DATE,
REGION VARCHAR2(10));

CREATE TABLE SALES_PRODUCT(
PRODUCT_ID NUMERIC CONSTRAINT PRODUCT_ID PRIMARY KEY,
PRODUCT_NAME VARCHAR2(100),
STANDARD_COST NUMERIC(10,2),
COLOR VARCHAR2(20),
LIST_PRICE NUMERIC(10,2),
PRODUCT_SIZE NUMBER(8,2),
WEIGHT NUMBER(10,2),
PRODUCT_CATEGORY VARCHAR2(20));

CREATE TABLE SALES_SALESPERSON(
SALESPERSON_ID NUMERIC CONSTRAINT SALESPERSON_ID PRIMARY KEY,
JOB_TITLE VARCHAR2(80),
FIRST_NAME VARCHAR2(50),
LAST_NAME VARCHAR2(50),
MIDDLE_NAME VARCHAR2(50),
ADDRESS_LINE1 VARCHAR2(80),
ADDRESS_LINE2 VARCHAR2(80),
CITY VARCHAR2(40),
COUNTRY VARCHAR2(50),
DATE_ADDED DATE,
MANAGER VARCHAR2(20));

CREATE TABLE SALES_HISTORY(
ORDER_ID NUMERIC CONSTRAINT ORDER_ID PRIMARY KEY,
SALES_DATE DATE,
PRODUCT_ID NUMERIC,
CUSTOMER_ID NUMERIC,
SALESPERSON_ID NUMERIC,
QUANTITY NUMERIC,
UNIT_PRICE NUMERIC(10,2),
SALES_AMOUNT NUMERIC(10,2),
TAX_AMOUNT NUMERIC(10,2),
TOTAL_AMOUNT NUMERIC(10,2),
CONSTRAINT SH_PRODUCT_ID FOREIGN KEY (PRODUCT_ID) REFERENCES SALES_PRODUCT(PRODUCT_ID),
CONSTRAINT SH_CUSTOMER_ID FOREIGN KEY (CUSTOMER_ID) REFERENCES SALES_CUSTOMER(CUSTOMER_ID),
CONSTRAINT SH_SALESPERSON_ID FOREIGN KEY (SALESPERSON_ID) REFERENCES SALES_SALESPERSON(SALESPERSON_ID));

INSERT INTO SALES_CUSTOMER
VALUES(002,'John','Snow',NULL,'1111 S Figueroa St',NULL,'Los Angeles','USA','18-OCT-2018','ABC');

INSERT INTO SALES_CUSTOMER
VALUES(003,'Peter','Rowe','Larry','4 Pennsylvania Plaza',NULL,'New York','USA','18-NOV-2017','Atlantic');

INSERT INTO SALES_CUSTOMER
VALUES(006,'Jennifer',NULL,'Hensley','3826 Bernardo Street',NULL,'Salem','USA','29-JAN-2014','Midwest');

INSERT INTO SALES_CUSTOMER
VALUES(007,'Lori',NULL,'Gonzalez','3780 Centennial Farm Road',NULL,'Remsen','USA','05-MAY-2016','Atlantic');

INSERT INTO SALES_CUSTOMER
VALUES(004,'Diana','Taurasi',NULL,'201 East Jefferson Street',NULL,'Phoenix','USA','08-DEC-2017','Pacific');

INSERT INTO SALES_CUSTOMER
VALUES(005,'Kobe','Bryant','Bean','1111 S Figueroa St',NULL,'Los Angeles','USA','10-JAN-2015','Pacific');

INSERT INTO SALES_SALESPERSON
VALUES(001,'Entry Salesperson','Clark','Davis',NULL,'1111 Indiana St',NULL,'Lawrence','USA','18-OCT-2018','Yes');

INSERT INTO SALES_SALESPERSON
VALUES(002,'Entry Salesperson','Wilma','Horning',NULL,'2552 Wescam Court',NULL,'Saugus','USA','27-JAN-2016','No');

INSERT INTO SALES_SALESPERSON
VALUES(003,'Associate Salesperson','Linda','Kennemer',NULL,'2145 Lena Lane',NULL,'Hattiesburg','USA','25-FEB-2016','No');

INSERT INTO SALES_SALESPERSON
VALUES(004,'Associate Salesperson','Roger','Capps',NULL,'2461 Shinn Avenue',NULL,'Pittsburgh','USA','01-MAR-2017','No');

INSERT INTO SALES_SALESPERSON
VALUES(005,'Senior Salesperson','Jose','Putnam',NULL,'636 Millbrook Road',NULL,'Geneva','USA','07-APR-2019','Yes');

INSERT INTO SALES_SALESPERSON
VALUES(006,'Senior Salesperson','Priscilla','Ware',NULL,'1749 Grove Street',NULL,'Garden City','USA','10-MAY-2013','Yes');

INSERT INTO SALES_PRODUCT
VALUES(001,'Stone Coaster',1.99,'Grey',4.99,2.2,0.5,'Homeware');

INSERT INTO SALES_PRODUCT
VALUES(002,'Desk Lamp',3.99,'Grey',9.99,4.2,2,'Office');

INSERT INTO SALES_PRODUCT
VALUES(003,'Coffee Mug',0.99,'White',4.99,2,0.5,'Kitchen');

INSERT INTO SALES_PRODUCT
VALUES(004,'Television',19.99,'Black',99.99,10,22,'Electronics');

INSERT INTO SALES_PRODUCT
VALUES(005,'Wall Clock',2.99,'Grey',9.99,5,3,'Homeware');

INSERT INTO SALES_PRODUCT
VALUES(006,'Headphones',9.99,'White',49.99,2,0.25,'Electronics');

INSERT INTO SALES_HISTORY
VALUES(001,'12-MAY-2019',003,002,001,1000,5,5000,500,5500);

INSERT INTO SALES_HISTORY
VALUES(002,'11-OCT-2013',001,003,004,10,5,50,5,55);

INSERT INTO SALES_HISTORY
VALUES(003,'05-JAN-2015',004,002,005,2,100,200,20,220);

INSERT INTO SALES_HISTORY
VALUES(004,'05-JAN-2016',002,002,005,2,100,200,20,220);

INSERT INTO SALES_HISTORY
VALUES(005,'01-FEB-2014',005,004,002,5,10,50,5,55);

INSERT INTO SALES_HISTORY
VALUES(006,'09-AUG-2018',001,003,001,5,5,25,2.5,27.5);

INSERT INTO SALES_HISTORY
VALUES(007,'22-SEP-2017',002,004,003,5,10,50,5,55);

INSERT INTO SALES_HISTORY
VALUES(008,'28-NOV-2016',006,002,001,1,50,50,5,55);

INSERT INTO SALES_HISTORY
VALUES(009,'02-JUN-2019',001,005,002,8,5,40,4,44);

INSERT INTO SALES_HISTORY
VALUES(010,'03-MAY-2014',004,006,003,1,100,100,10,110);

INSERT INTO SALES_HISTORY
VALUES(011,'11-JUL-2018',005,007,004,3,10,30,3,33);

SELECT * FROM SALES_HISTORY;
SELECT * FROM SALES_CUSTOMER; 
SELECT * FROM SALES_SALESPERSON;
SELECT * FROM SALES_PRODUCT;

--16--
Select SALESPERSON_ID, FIRST_NAME, LAST_NAME, JOB_TITLE, MANAGER 
FROM SALES_SALESPERSON 
WHERE SALESPERSON_ID NOT IN (SELECT salesperson_ID FROM SALES_HISTORY)


-15--

Select *
From SALES_HISTORY
WHERE TOTAL_AMOUNT != (SELECT MAX(TOTAL_AMOUNT) FROM SALES_HISTORY);



